# Clinical Laboratory - Console Management System

## General Description
This is a console-based management system for a clinical laboratory, developed in C. It allows for the administration of clients, employees, exams, expense recording, and the generation of various financial and operational reports. It's a console application that simulates the basic operations of a laboratory, specifically designed for Windows environments due to the libraries used.

## Features
*   **Login System:** Authentication system with a predefined username and password (`ADMIN`/`1234`). The application manages a fictitious date cycle that advances daily (although the displayed date on login is static).
*   **Client Management:**
    *   Registration of new clients with their name, surname, DNI (identification number), type of exam performed, and amount paid.
    *   Validation of the exam type against a predefined list.
*   **Employee Management:**
    *   Registration of new employees with their name, surname, DNI, specialization, and monthly salary.
    *   **Note:** The specialization validation is incorrectly performed against the list of exams.
*   **Exam Management:**
    *   Display of the list of available exams.
    *   Functionality to add new exams to the laboratory's catalog, including validation to prevent duplicates.
*   **Expense Recording:**
    *   Allows entering multiple expenses, detailing the expense name, amount, date (automatically generated by the system), and category.
*   **Reports:** A dedicated menu for generating various reports:
    *   **Employee Report:** Displays a table with all registered employees, their personal data, and salary, as well as the total payroll cost.
    *   **Client Report:** Presents a table with all clients, their personal data, payment made, and the type of exam.
    *   **Report by Exam Type:** Allows searching for and listing clients who underwent a specific exam.
    *   **Client with Highest Expense:** Identifies and displays the details of the client who made the highest payment.
    *   **Most Requested Exam:** Attempts to identify the most frequent exam type (the counting logic might require review).
    *   **Income Report:** Shows the total accumulated income from client payments.
    *   **Expense Report:** Lists all recorded expenses with their details and the total accumulated expenses.
    *   **Profit Report:** Calculates and displays the daily profit by subtracting daily expenses and salaries from total accumulated income.
*   **Configuration:** Allows administrators to:
    *   Change the login username.
    *   Change the login password.
    *   Add new exam types to the catalog.
*   **User Interface:** Utilizes functions from the `windows.h` and `conio.h` libraries to create an interactive text-based console interface, including:
    *   Boxes and borders to structure information.
    *   Automatic text centering.
    *   A visual loading bar for screen transitions.
    *   User input with character masking (asterisks) for passwords.
    *   Basic input validation (empty fields, invalid options).

## Code Structure

### Header Files Used
*   `<string.h>`: For string manipulation functions (e.g., `strcpy`, `strcmp`, `strcasecmp`).
*   `<conio.h>`: Contains console input/output functions, such as `_getch()` for unbuffered character input.
*   `<stdlib.h>`: Provides general-purpose functions, including `system()` to execute system commands (e.g., `cls` to clear the screen).
*   `<stdio.h>`: The standard input/output library (e.g., `printf`, `scanf`, `gets`).
*   `<windows.h>`: Essential for console interaction on Windows, providing functions like `SetConsoleCursorPosition` (for `gotoxy`), `GetStdHandle`, and `Sleep` (for pauses).
*   `<stdbool.h>`: Defines the boolean type `bool` and `true`/`false` values.
*   `#pragma GCC diagnostic ignored "-Wwrite-strings"`: Disables a specific GCC compiler warning related to using string literals in contexts expecting modifiable `char*` pointers.

### Data Structures
*   `Gasto` (Expense):
    *   `char nombre[TAM]`: Name or description of the expense.
    *   `float cantidad`: Monetary amount of the expense.
    *   `char fecha[TAM]`: (Not directly used, superseded by `dia`, `mes`, `year`).
    *   `char categoria[TAM]`: Category to which the expense belongs.
    *   `int dia`, `int year`: Day and year of the expense.
    *   `char mes[TAM]`: Month of the expense (as a string).
*   `clientes` (Clients):
    *   `char nombre[TAM]`, `char apellido[TAM]`: Client's name and surname.
    *   `char DNI[TAM]`: Client's National Identity Document.
    *   `char tipo_examen[TAM]`: Type of exam the client underwent.
    *   `float pago`: Amount paid by the client.
*   `empleados` (Employees):
    *   `char nombre[TAM]`, `char apellido[TAM]`: Employee's name and surname.
    *   `char DNI[TAM]`: Employee's National Identity Document.
    *   `char especializacion[TAM]`: Employee's specialization.
    *   `float sueldo`: Employee's monthly salary.
*   `dinero` (Money/Finances):
    *   `float ingresos`, `float nomina`, `float costos`, `float totalGastos`, `float utilidad`: Fields to store different financial values. Some of these variables are not fully utilized in the current implementation as part of this structure.

### Global Variables
*   `Gasto g[TAM]`: Global array to store `Gasto` objects.
*   `int num_gastos`: Counter for recorded expenses.
*   `float total_gastos`: Total sum of expenses (might be redundant with `calcularGastos()`).
*   `clientes cliente[TAM]`: Global array to store `clientes` objects.
*   `empleados empleado[TAM]`: Global array to store `empleados` objects.
*   `dinero finanzas`: Global variable of type `dinero` for financial calculations.
*   `int indice`: A general counter used for `clientes` and `empleados` (can lead to confusion).
*   `int indice_c`: Index for client insertion.
*   `int indice_e`: Index for employee insertion.
*   `int indice_g`: Index for expense insertion.
*   `char examenes[TAM][TAM]`: Character matrix that stores the names of available exams.
*   `char usuario1[TAM]`, `char clave1[TAM]`: Login credentials (`ADMIN`/`1234`).
*   `HANDLE wHnd`: Console window handle for `windows.h` functions.

### Auxiliary Functions (Console Graphical Interface)
*   `void gotoxy(int x, int y)`: Moves the cursor to console coordinates (x, y).
*   `void recuadro(int xs, int ys, int xi, int yi)`: Draws a box using extended ASCII characters between the given coordinates.
*   `void centrarTexto(char *texto, int y)`: Prints a text string horizontally centered on row `y`.
*   `void margen()`: Draws the main border and header of the application.
*   `void barra_de_carga()`: Displays a loading bar animation.
*   `void asteriscos(char caracter, char *respuesta, int indice, bool mostrador, int longitud)`: Captures user input, displaying asterisks if `mostrador` is `true` (for passwords) or the actual character if `false`.
*   `void espacios_vacios(char *texto, int x, int y)`: Checks if a text string is empty and prompts the user to fill it if so.
*   `void borrar_espacios(int x, int y)`: Clears a block of text on the console.
*   `void tabla(int x, int fila)`: Draws vertical lines for report tables.

### Business Logic Functions
*   `float calcularIngresos()`: Iterates over registered clients and sums their payments to get the total income.
*   `float calcularGastos()`: Iterates over recorded expenses and sums their amounts to get the total expenses.
*   `float calcularSueldos()`: Iterates over registered employees and sums their salaries to get the total cost of salaries.
*   `float calcularGanancia()`: Calculates the daily profit by subtracting the daily proportion of expenses and salaries from the total accumulated income.

## Compilation and Execution
To compile the program on a Windows system with GCC (MinGW, TDM-GCC, etc.), open a terminal or Command Prompt and execute the following command:

```bash
gcc "Proyecto_acabado (1).c" -o clinical_laboratory.exe -luser32
```
*   `gcc`: The GNU C compiler command.
*   `"Proyecto_acabado (1).c"`: The name of your source file.
*   `-o clinical_laboratory.exe`: Instructs the compiler to generate an executable file named `clinical_laboratory.exe`.
*   `-luser32`: Links the `user32.lib` library, necessary for some `windows.h` functions.

Once compiled, you can run the application from the same terminal:

```bash
.\clinical_laboratory.exe
```

## Notes and Possible Improvements
*   **Portability:** The extensive use of `windows.h` and `conio.h` makes the application not directly portable to other operating systems like Linux or macOS.
*   **Date Management:** The date displayed on login is static ("11/05/2024") despite an internal date system that advances dynamically. The dynamic date could be integrated into the display.
*   **Input Validation:** Some validations are basic. It could be improved to prevent numeric input in text fields and vice versa, as well as specific formats for DNI or dates.
*   **Data Persistence:** Data is lost each time the application closes, as there is no mechanism to save and load information (e,g., to files or a database).
*   **Report Logic:**
    *   The logic for the "Most Requested Exam" (`max_contador`, `tipo_max_contador`) seems incomplete or incorrect, as the `contador` array is not initialized or updated with exam frequency.
    *   The validation of employee "specialization" against the list of exams is a logical error; there should be a separate list of specializations or no validation.
*   **Use of `fflush(stdin)`:** This is a non-standard practice and can cause issues in different compilers or systems. It is recommended to avoid its use.
*   **Redundancy:** `total_gastos` as a global variable and `calcularGastos()` are somewhat redundant; the function could be relied upon more consistently.
*   **Organization:** The code could benefit from greater modularization, dividing functions into header files (`.h`) and implementation files (`.c`) for better organization.

---
**Team Project:**
*   Angel Nereo Molina Ortiz 30201824
*   Johan Omar Duque Pereira 30.920.845
*   Arturo Alejandro Carvajalino Vivas 30.889.966
